{"version":3,"sources":["../../../../assets/script/assets/script/hook.js"],"names":["cc","Class","extends","Component","properties","moveSpeed","down","flag","occupied","downPlaying","item","Node","bigGold","default","type","AudioClip","getDown","goods","onKeyDown","event","keyCode","macro","KEY","onCollisionEnter","other","self","node","_name","audioEngine","play","onLoad","animationComponent","getComponent","Animation","initX","x","initY","y","playing","systemEvent","on","SystemEvent","EventType","KEY_DOWN","start","update","dt","stop","theta","getRotation","Math","PI","sin","cos","Global","powers"],"mappings":"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","file":"hook.js","sourceRoot":"../../../../assets/script","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n  extends: cc.Component,\n\n  properties: {\n    moveSpeed: 6,\n    down: false,\n    flag: 0,\n    occupied: false,\n    downPlaying: false,\n    item: cc.Node,\n    bigGold: {\n      default: null,\n      type: cc.AudioClip\n    },\n    getDown: {\n      default: null,\n      type: cc.AudioClip\n    },\n    goods: {\n      default: null,\n      type: cc.AudioClip\n    }\n  },\n\n  onKeyDown (event) {\n    // set a flag when key pressed\n    switch (event.keyCode) {\n      case cc.macro.KEY.down:\n        this.down = true\n        break\n    }\n  },\n\n  onCollisionEnter: function (other, self) {\n    if (!this.occupied) {\n      if (other.node._name === 'bigGold' || other.node._name === 'treasure') {\n        cc.audioEngine.play(this.bigGold, false, 1)\n      } else if (other.node._name === 'midGold' || other.node._name === 'pocket' || other.node._name === 'diamond' || other.node._name === 'diamondPig') {\n        cc.audioEngine.play(this.goods, false, 1)\n      }\n    }\n  },\n\n  // LIFE-CYCLE CALLBACKS:\n\n  onLoad: function () {\n    this.animationComponent = this.getComponent(cc.Animation)\n    this.initX = this.node.x\n    this.initY = this.node.y\n    this.animationComponent.play('hookRotation')\n    this.playing = true\n    cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this)\n  },\n\n  start () {\n\n  },\n\n  update (dt) {\n    if (this.down && this.flag !== 2) {\n      if (!this.downPlaying) {\n        this.downPlaying = true\n        cc.audioEngine.play(this.getDown, false, 1)\n      }\n\n      this.flag = 1\n      this.playing = false\n      this.animationComponent.stop('hookRotation')\n      this.animationComponent.stop('hookRotation2')\n      this.animationComponent.stop('hookRotation3')\n      const theta = this.node.getRotation() * (Math.PI / 180)\n      this.node.x -= this.moveSpeed * Math.sin(theta)\n      this.node.y -= this.moveSpeed * Math.cos(theta)\n\n      if ((this.node.x < -450) || (this.node.x > 450) || (this.node.y < -240)) {\n        this.down = false\n        this.occupied = true\n      }\n    } else {\n      if (this.node.y < this.initY) {\n        this.flag = 2\n        this.playing = false\n        const theta = this.node.getRotation() * (Math.PI / 180)\n        if (Global.powers > 0) {\n          if (this.moveSpeed === 6) {\n            this.node.x += this.moveSpeed * Math.sin(theta)\n            this.node.y += this.moveSpeed * Math.cos(theta)\n          } else {\n            this.node.x += 5 * Math.sin(theta)\n            this.node.y += 5 * Math.cos(theta)\n          }\n        } else {\n          this.node.x += this.moveSpeed * Math.sin(theta)\n          this.node.y += this.moveSpeed * Math.cos(theta)\n        }\n        this.down = false\n      } else {\n        this.downPlaying = false\n        this.flag = 3\n        this.node.x = this.initX\n        this.node.y = this.initY\n        this.moveSpeed = 6\n        this.item = null\n        if (!this.playing) {\n          this.occupied = false\n          if (this.node.getRotation() > 30) {\n            this.animationComponent.play('hookRotation2')\n          } else if (this.node.getRotation() < -30) {\n            this.animationComponent.play('hookRotation3')\n          } else {\n            this.animationComponent.play('hookRotation')\n          }\n          this.playing = true\n        }\n      }\n    }\n  }\n})\n"]}