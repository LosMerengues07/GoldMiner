{"version":3,"sources":["..\\..\\..\\..\\assets\\script/assets\\script\\hook.js"],"names":["cc","Class","extends","Component","properties","moveSpeed","down","flag","occupied","downPlaying","item","Node","bigGold","default","type","AudioClip","getDown","goods","onKeyDown","event","keyCode","macro","KEY","onCollisionEnter","other","self","node","_name","audioEngine","play","onLoad","animationComponent","getComponent","Animation","initX","x","initY","y","playing","systemEvent","on","SystemEvent","EventType","KEY_DOWN","start","update","dt","stop","theta","getRotation","Math","PI","sin","cos","Global","powers"],"mappings":"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","file":"hook.js","sourceRoot":"..\\..\\..\\..\\assets\\script","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n  extends: cc.Component,\r\n\r\n  properties: {\r\n    moveSpeed: 6,\r\n    down: false,\r\n    flag: 0,\r\n    occupied: false,\r\n    downPlaying: false,\r\n    item: cc.Node,\r\n    bigGold: {\r\n      default: null,\r\n      type: cc.AudioClip\r\n    },\r\n    getDown: {\r\n      default: null,\r\n      type: cc.AudioClip\r\n    },\r\n    goods: {\r\n      default: null,\r\n      type: cc.AudioClip\r\n    }\r\n  },\r\n\r\n  onKeyDown (event) {\r\n    // set a flag when key pressed\r\n    switch (event.keyCode) {\r\n      case cc.macro.KEY.down:\r\n        this.down = true\r\n        break\r\n    }\r\n  },\r\n\r\n  onCollisionEnter: function (other, self) {\r\n    if (!this.occupied) {\r\n      if (other.node._name === 'bigGold' || other.node._name === 'treasure') {\r\n        cc.audioEngine.play(this.bigGold, false, 1)\r\n      } else if (other.node._name === 'midGold' || other.node._name === 'pocket' || other.node._name === 'diamond' || other.node._name === 'diamondPig') {\r\n        cc.audioEngine.play(this.goods, false, 1)\r\n      }\r\n    }\r\n  },\r\n\r\n  // LIFE-CYCLE CALLBACKS:\r\n\r\n  onLoad: function () {\r\n    this.animationComponent = this.getComponent(cc.Animation)\r\n    this.initX = this.node.x\r\n    this.initY = this.node.y\r\n    this.animationComponent.play('hookRotation')\r\n    this.playing = true\r\n    cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this)\r\n  },\r\n\r\n  start () {\r\n\r\n  },\r\n\r\n  update (dt) {\r\n    if (this.down && this.flag !== 2) {\r\n      if (!this.downPlaying) {\r\n        this.downPlaying = true\r\n        cc.audioEngine.play(this.getDown, false, 1)\r\n      }\r\n\r\n      this.flag = 1\r\n      this.playing = false\r\n      this.animationComponent.stop('hookRotation')\r\n      this.animationComponent.stop('hookRotation2')\r\n      this.animationComponent.stop('hookRotation3')\r\n      const theta = this.node.getRotation() * (Math.PI / 180)\r\n      this.node.x -= this.moveSpeed * Math.sin(theta)\r\n      this.node.y -= this.moveSpeed * Math.cos(theta)\r\n\r\n      if ((this.node.x < -450) || (this.node.x > 450) || (this.node.y < -240)) {\r\n        this.down = false\r\n        this.occupied = true\r\n      }\r\n    } else {\r\n      if (this.node.y < this.initY) {\r\n        this.flag = 2\r\n        this.playing = false\r\n        const theta = this.node.getRotation() * (Math.PI / 180)\r\n        if (Global.powers > 0) {\r\n          if (this.moveSpeed === 6) {\r\n            this.node.x += this.moveSpeed * Math.sin(theta)\r\n            this.node.y += this.moveSpeed * Math.cos(theta)\r\n          } else {\r\n            this.node.x += 5 * Math.sin(theta)\r\n            this.node.y += 5 * Math.cos(theta)\r\n          }\r\n        } else {\r\n          this.node.x += this.moveSpeed * Math.sin(theta)\r\n          this.node.y += this.moveSpeed * Math.cos(theta)\r\n        }\r\n        this.down = false\r\n      } else {\r\n        this.downPlaying = false\r\n        this.flag = 3\r\n        this.node.x = this.initX\r\n        this.node.y = this.initY\r\n        this.moveSpeed = 6\r\n        this.item = null\r\n        if (!this.playing) {\r\n          this.occupied = false\r\n          if (this.node.getRotation() > 30) {\r\n            this.animationComponent.play('hookRotation2')\r\n          } else if (this.node.getRotation() < -30) {\r\n            this.animationComponent.play('hookRotation3')\r\n          } else {\r\n            this.animationComponent.play('hookRotation')\r\n          }\r\n          this.playing = true\r\n        }\r\n      }\r\n    }\r\n  }\r\n})\r\n"]}