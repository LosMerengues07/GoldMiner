{"version":3,"sources":["game.js"],"names":["cc","Class","extends","Component","properties","draw","Graphics","player1","Node","base","hook","moneyLabel1","Label","add1","addFire","levelLabel","money1","target","countDown","exit","powerLogo","onLoad","director","getCollisionManager","enabledDebugDraw","enabled","onTouchExit","event","loadScene","start","broadcostTimes","schedule","doCountdownTime","Global","currentMoney","targets","currentLevel","string","on","EventType","TOUCH_START","console","log","fire1","find","getComponent","fires","num","betterDiamonds","powers","luckys","stoneBooks","loseMoney","update","dt","clear","startPos","convertToWorldSpaceAR","v2","endPos","lineWidth","moveTo","x","y","lineTo","stroke","opacity"],"mappings":"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","file":"game.js","sourceRoot":"../../../../assets/script","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n  extends: cc.Component,\n\n  properties: {\n    draw: cc.Graphics,\n    player1: cc.Node,\n    base: cc.Node,\n    hook: cc.Node,\n    moneyLabel1: cc.Label,\n    add1: cc.Label,\n    addFire: cc.Label,\n    levelLabel: cc.Label,\n    money1: 0,\n    target: 0,\n    countDown: cc.Label,\n    exit: cc.Node,\n    powerLogo: cc.Node,\n  },\n\n  // LIFE-CYCLE CALLBACKS:\n\n  onLoad () {\n    cc.director.getCollisionManager().enabledDebugDraw = false\n    cc.director.getCollisionManager().enabled = true\n    // this.schedule(this.doCountdownTime,1);\n  },\n  onTouchExit(event){\n    cc.director.loadScene('start')\n  },\n\n  start () {\n    this.broadcostTimes = 30\n    this.schedule(this.doCountdownTime, 1)\n    this.money1 = Global.currentMoney\n    this.target = Global.targets[Global.currentLevel - 1]\n    this.levelLabel.string = 'Level ' + Global.currentLevel + '\\nTarget: $' + this.target\n    this.exit.on(cc.Node.EventType.TOUCH_START, this.onTouchExit, this)\n  },\n\n  // 倒计时\n  doCountdownTime () {\n    this.countDown.string = '-' + this.broadcostTimes + 's'\n    this.broadcostTimes -= 1\n    if (this.broadcostTimes === -1) {\n      if (this.money1 >= this.target) {\n        console.log('You win! Next Level!')\n        const fire1 = cc.find('Canvas/fire1').getComponent('fire1')\n        Global.currentMoney = this.money1\n        Global.fires = fire1.num\n        Global.betterDiamonds = 0\n        Global.powers = 0\n        Global.luckys = 0\n        Global.stoneBooks = 0\n        if (Global.currentLevel === 8) {\n          cc.director.loadScene('pass')\n        } else {\n          Global.currentLevel++\n          cc.director.loadScene('next')\n        }\n      } else {\n        Global.loseMoney = this.money1\n        cc.director.loadScene('lose')\n      }\n    }\n  },\n\n  update (dt) {\n    this.draw.clear()\n    const startPos = this.base.convertToWorldSpaceAR(cc.v2(0, 1))\n    const endPos = this.hook.convertToWorldSpaceAR(cc.v2(-0.1, -25.3))\n    this.draw.lineWidth = 4.5\n    this.draw.moveTo(startPos.x, startPos.y)\n    this.draw.lineTo(endPos.x, endPos.y)\n    this.draw.stroke()\n\n    this.moneyLabel1.string = '$ ' + this.money1\n    if (Global.powers > 0) {\n      this.powerLogo.opacity = 255\n    } else {\n      this.powerLogo.opacity = 0\n    }\n  }\n})\n"]}